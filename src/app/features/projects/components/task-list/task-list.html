<div class="space-y-4">

  <!-- ADD TASK -->
  <div class="flex gap-2">
    <input
      type="text"
      placeholder="Nouvelle tÃ¢che..."
      [(ngModel)]="newTaskTitle"
      class="flex-1 bg-white/10 border border-white/20 rounded-xl px-4 py-2.5 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-green-500 transition text-sm"
    />

    <select
      [(ngModel)]="newTaskPriority"
      class="bg-white/10 border border-white/20 rounded-xl px-3 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-green-500 transition text-sm"
    >
      <option class="bg-slate-800" value="Haute">ğŸ”´ Haute</option>
      <option class="bg-slate-800" value="Moyenne">ğŸŸ¡ Moyenne</option>
      <option class="bg-slate-800" value="Basse">ğŸŸ¢ Basse</option>
    </select>

    <button
      (click)="addTask()"
      class="bg-green-600 hover:bg-green-500 text-white px-4 rounded-xl transition shadow-lg shadow-green-500/20 flex items-center justify-center"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
      </svg>
    </button>
  </div>

  <!-- TASK LIST -->
  @for (task of tasks; track task.title; let i = $index) {
    <div
      appHighlightStatus="{{task.status}}"
      class="group bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 rounded-xl px-4 py-3 flex justify-between items-center transition-all duration-200"
      [ngClass]="task.priority | priorityColor"
    >
      <div class="flex items-start gap-3 flex-1">

        <!-- Status indicator dot -->
        <div class="mt-1.5 flex-shrink-0">
          @if (task.status === 'TerminÃ©') {
            <div class="w-3 h-3 rounded-full bg-green-400 shadow shadow-green-400/50"></div>
          } @else if (task.status === 'En cours') {
            <div class="w-3 h-3 rounded-full bg-yellow-400 shadow shadow-yellow-400/50"></div>
          } @else {
            <div class="w-3 h-3 rounded-full bg-slate-500"></div>
          }
        </div>

        <div class="flex-1 space-y-2">
          <h4 class="font-semibold text-white text-sm">{{ task.title }}</h4>

          <div class="flex gap-2">
            <select
              [(ngModel)]="task.priority"
              class="bg-white/10 border border-white/15 rounded-lg px-2 py-1 text-xs text-slate-300 focus:outline-none focus:ring-1 focus:ring-blue-500 transition"
            >
              <option class="bg-slate-800" value="Haute">ğŸ”´ Haute</option>
              <option class="bg-slate-800" value="Moyenne">ğŸŸ¡ Moyenne</option>
              <option class="bg-slate-800" value="Basse">ğŸŸ¢ Basse</option>
            </select>

            <select
              [(ngModel)]="task.status"
              class="bg-white/10 border border-white/15 rounded-lg px-2 py-1 text-xs text-slate-300 focus:outline-none focus:ring-1 focus:ring-blue-500 transition"
            >
              <option class="bg-slate-800" value="En attente">â³ En attente</option>
              <option class="bg-slate-800" value="En cours">âš¡ En cours</option>
              <option class="bg-slate-800" value="TerminÃ©">âœ… TerminÃ©</option>
            </select>
          </div>
        </div>
      </div>

      <button
        (click)="openDeleteModal(i)"
        class="ml-3 p-2 rounded-lg text-slate-500 hover:text-red-400 hover:bg-red-500/10 border border-transparent hover:border-red-500/30 transition opacity-0 group-hover:opacity-100"
      >
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
        </svg>
      </button>
    </div>
  }

</div>

<!-- DELETE MODAL -->
@if (taskToDeleteIndex !== null) {
  <div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50">
    <div class="bg-slate-900 border border-white/20 rounded-2xl p-6 w-80 space-y-5 shadow-2xl">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 bg-red-500/20 rounded-xl flex items-center justify-center">
          <svg class="w-5 h-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
          </svg>
        </div>
        <h2 class="text-lg font-bold text-white">Supprimer la tÃ¢che</h2>
      </div>

      <p class="text-slate-400 text-sm">Voulez-vous vraiment supprimer cette tÃ¢che ? Cette action est irrÃ©versible.</p>

      <div class="flex justify-end gap-3">
        <button
          (click)="cancelDelete()"
          class="px-5 py-2.5 bg-white/10 hover:bg-white/20 text-white rounded-xl transition font-medium border border-white/20 text-sm"
        >
          Annuler
        </button>
        <button
          (click)="confirmDelete()"
          class="px-5 py-2.5 bg-red-600 hover:bg-red-500 text-white rounded-xl transition font-medium shadow-lg shadow-red-500/30 text-sm"
        >
          Supprimer
        </button>
      </div>
    </div>
  </div>
}
